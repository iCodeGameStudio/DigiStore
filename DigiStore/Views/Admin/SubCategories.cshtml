@model IEnumerable<DigiStore.DataAccessLayer.Entities.Category>

@{
    ViewData["Title"] = "زیر دسته بندی ها";
    Layout = "~/Views/Shared/_Panel.cshtml";
    int categoryID = ViewBag.MyId;
}

<section class="content">
    <div class="row">
        <div class="col-lg-12 col-12">
            <!-- دکمه باز کردن -->
            <button onclick="AddSubCategoryModal(@categoryID)" class="btn btn-facebook" data-toggle="modal" data-target="#MiniModel" data-title="ایجاد زیر دسته جدید">
                ایجاد زیر دسته جدید
            </button>
        </div>
        <div class="clearfix"></div>

        <div class="col-lg-6 col-12">
            <div class="box">
                <div class="box-header with-border">
                    <h4 class="box-title">سر دسته و زیر دسته بندی ها</h4>
                </div>
                <div class="box-body">
                    <div class="panel-group">
                        @foreach (var item in Model.Where(x => x.ParentId == categoryID))
                        {
                            <div class="panel panel-default">
                                <div class="panel-heading">
                                    <h4 class="panel-title d-flex justify-content-between align-items-center">
                                        <a role="button" data-toggle="collapse" aria-expanded="true" data-parent="#@item.Id" href="#@item.Id">
                                            @item.Name
                                        </a>
                                        <div>
                                            <a href="#" onclick="AddSubCategoryModal(@item.Id)" class="btn btn-sm btn-success" style="margin-left: 10px; margin-right: 10px;" title="افزودن" data-toggle="modal" data-target="#MiniModel" data-title="افزودن زیر دسته جدید">
                                                <i class="fa fa-plus-circle"></i>
                                                <span class="d-none d-sm-inline">افزودن</span>
                                            </a>
                                            <a href="#" onclick="EditCategoryModal(@item.Id)" class="btn btn-sm btn-warning" style="margin-left: 10px;" title="ویرایش" data-toggle="modal" data-target="#MiniModel" data-title="ویرایش زیر دسته">
                                                <i class="fa fa-edit"></i>
                                                <span class="d-none d-sm-inline">ویرایش</span>
                                            </a>
                                            <a href="#" onclick="DeleteCategoryModal(@item.Id)" class="btn btn-sm btn-danger" style="margin-left: 10px;" title="حذف" data-toggle="modal" data-target="#MiniModel" data-title="تأیید حذف">
                                                <i class="fa fa-trash"></i>
                                                <span class="d-none d-sm-inline">حذف</span>
                                            </a>
                                        </div>
                                    </h4>
                                </div>
                                <div id="@item.Id" class="panel-collapse collapse">
                                    <div class="panel-body">
                                        @if (Model.Any(x => x.ParentId == item.Id))
                                        {
                                            @foreach (var subitem in Model.Where(x => x.ParentId == item.Id))
                                            {
                                                <div class="panel panel-default">
                                                    <div class="panel-heading">
                                                        <h4 class="panel-title">
                                                            <div class="d-flex justify-content-between align-items-center">
                                                                <a role="button" aria-expanded="true" data-toggle="collapse" data-parent="#@subitem.Id" href="#@subitem.Id">
                                                                    @subitem.Name
                                                                </a>
                                                                <div>
                                                                    <a href="#" onclick="AddSubCategoryModal(@subitem.Id)" class="btn btn-sm btn-success" style="margin-left: 10px; margin-right: 10px;" title="افزودن" data-toggle="modal" data-target="#MiniModel" data-title="افزودن زیر دسته جدید">
                                                                        <i class="fa fa-plus-circle"></i>
                                                                        <span class="d-none d-sm-inline">افزودن</span>
                                                                    </a>
                                                                    <a href="#" onclick="EditCategoryModal(@subitem.Id)" class="btn btn-sm btn-warning" style="margin-left: 10px;" title="ویرایش" data-toggle="modal" data-target="#MiniModel" data-title="ویرایش زیر دسته">
                                                                        <i class="fa fa-edit"></i>
                                                                        <span class="d-none d-sm-inline">ویرایش</span>
                                                                    </a>
                                                                    <a href="#" onclick="DeleteCategoryModal(@subitem.Id)" class="btn btn-sm btn-danger" style="margin-left: 10px;" title="حذف" data-toggle="modal" data-target="#MiniModel" data-title="تأیید حذف">
                                                                        <i class="fa fa-trash"></i>
                                                                        <span class="d-none d-sm-inline">حذف</span>
                                                                    </a>
                                                                </div>
                                                            </div>
                                                        </h4>
                                                    </div>
                                                    <div id="@subitem.Id" class="panel-collapse collapse">
                                                        <div class="panel-body">
                                                            @if (Model.Any(x => x.ParentId == subitem.Id))
                                                            {
                                                                @foreach (var subsubitem in Model.Where(x => x.ParentId == subitem.Id))
                                                                {
                                                                    <div class="panel panel-default">
                                                                        <div class="panel-heading">
                                                                            <h4 class="panel-title">
                                                                                <div class="d-flex justify-content-between align-items-center">
                                                                                    <a role="button" aria-expanded="true" data-toggle="collapse" data-parent="#@subsubitem.Id" href="#@subsubitem.Id">
                                                                                        @subsubitem.Name
                                                                                    </a>
                                                                                    <div>
                                                                                        <a href="#" onclick="AddSubCategoryModal(@subsubitem.Id)" class="btn btn-sm btn-success" style="margin-left: 10px; margin-right: 10px;" title="افزودن" data-toggle="modal" data-target="#MiniModel" data-title="افزودن زیر دسته جدید">
                                                                                            <i class="fa fa-plus-circle"></i>
                                                                                            <span class="d-none d-sm-inline">افزودن</span>
                                                                                        </a>
                                                                                        <a href="#" onclick="EditCategoryModal(@subsubitem.Id)" class="btn btn-sm btn-warning" style="margin-left: 10px;" title="ویرایش" data-toggle="modal" data-target="#MiniModel" data-title="ویرایش زیر دسته">
                                                                                            <i class="fa fa-edit"></i>
                                                                                            <span class="d-none d-sm-inline">ویرایش</span>
                                                                                        </a>
                                                                                        <a href="#" onclick="DeleteCategoryModal(@subsubitem.Id)" class="btn btn-sm btn-danger" style="margin-left: 10px;" title="حذف" data-toggle="modal" data-target="#MiniModel" data-title="تأیید حذف">
                                                                                            <i class="fa fa-trash"></i>
                                                                                            <span class="d-none d-sm-inline">حذف</span>
                                                                                        </a>
                                                                                    </div>
                                                                                </div>
                                                                            </h4>
                                                                        </div>
                                                                        <div id="@subsubitem.Id" class="panel-collapse collapse">
                                                                            <div class="panel-body">
                                                                                @if (Model.Any(x => x.ParentId == subsubitem.Id))
                                                                                {
                                                                                    @foreach (var subsubsubitem in Model.Where(x => x.ParentId == subsubitem.Id))
                                                                                    {
                                                                                        <div class="panel panel-default">
                                                                                            <div class="panel-heading">
                                                                                                <h4 class="panel-title">
                                                                                                    <div>
                                                                                                        <a href="#">
                                                                                                            @subsubsubitem.Name
                                                                                                        </a>
                                                                                                        <a href="#" onclick="EditCategoryModal(@subsubsubitem.Id)" class="btn btn-sm btn-warning" style="margin-left: 10px;" title="ویرایش" data-toggle="modal" data-target="#MiniModel" data-title="ویرایش زیر دسته">
                                                                                                            <i class="fa fa-edit"></i>
                                                                                                            <span class="d-none d-sm-inline">ویرایش</span>
                                                                                                        </a>
                                                                                                        <a href="#" onclick="DeleteCategoryModal(@subsubsubitem.Id)" class="btn btn-sm btn-danger" style="margin-left: 10px;" title="حذف" data-toggle="modal" data-target="#MiniModel" data-title="تأیید حذف">
                                                                                                            <i class="fa fa-trash"></i>
                                                                                                            <span class="d-none d-sm-inline">حذف</span>
                                                                                                        </a>
                                                                                                    </div>
                                                                                                </h4>
                                                                                            </div>
                                                                                        </div>
                                                                                    }
                                                                                }
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                }
                                                            }
                                                        </div>
                                                    </div>
                                                </div>
                                            }
                                        }
                                    </div>
                                </div>
                            </div>
                        }
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-6 col-12">
            <div class="box">
                <div class="box-header with-border">
                    <h4 class="box-title">توضیحات</h4>
                </div>
                <div class="box-body">
                    <p>
                        ساختار دسته‌بندی محصولات در دیجی استور، یکی از جامع‌ترین و دقیق‌ترین سیستم‌ها در میان فروشگاه‌های آنلاین است. این دسته‌بندی‌ها به گونه‌ای طراحی شده‌اند که کاربران به سادگی بتوانند محصول مورد نظر خود را پیدا کنند و تجربه خریدی آسان و لذت‌بخش داشته باشند. این ساختار از دو سطح اصلی تشکیل شده است: دسته‌بندی‌های اصلی و زیردسته‌بندی‌ها.
                    </p>

                    <p>
                        دسته‌بندی‌های اصلی دیجی استور، شامل گروه‌های کلی محصولات مانند «کالای دیجیتال»، «مد و پوشاک»، «زیبایی و سلامت»، «خانه و آشپزخانه» و «کتاب، لوازم‌التحریر و هنر» می‌شوند. هر یک از این دسته‌بندی‌ها، مجموعه‌ای گسترده از کالاها را در خود جای داده و به عنوان نقطه شروعی برای جستجوی کاربران عمل می‌کنند. این تقسیم‌بندی کلی، به مشتریان کمک می‌کند تا از میان هزاران محصول موجود، به سرعت به بخش مرتبط با نیاز خود هدایت شوند.
                    </p>

                    <p>
                        زیردسته‌بندی‌ها، در واقع شاخه‌هایی دقیق‌تر از دسته‌بندی‌های اصلی هستند که به کاربران اجازه می‌دهند جستجوی خود را محدودتر و تخصصی‌تر کنند. به عنوان مثال، در دسته‌بندی اصلی «کالای دیجیتال»، زیردسته‌بندی‌هایی مانند «گوشی موبایل»، «لپ‌تاپ»، «هدفون، هدست و هندزفری» و «دوربین» وجود دارد. این ساختار سلسله‌مراتبی، فرآیند یافتن محصول را به شکل چشمگیری بهبود می‌بخشد و از سردرگمی مشتری در مواجهه با تنوع بالای محصولات جلوگیری می‌کند. هر زیردسته‌بندی نیز ممکن است دارای زیرشاخه‌های دقیق‌تری باشد که در نهایت به محصولات خاص منتهی می‌شود.
                    </p>
                </div>
            </div>
        </div>

    </div>
</section>


<div id="MiniModel" class="fade modal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content modern-modal">
            <!-- هدر -->
            <div class="modal-header">
                <h4 class="modal-title" id="MiniModelTitle">عنوان مودال</h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>

            <div id="MiniModelBody" class="modal-body">
                <!-- محتوا از AJAX میاد -->
            </div>
        </div>
    </div>
</div>



<style>
    .modal-backdrop {
        z-index: 1040 !important;
        position: fixed;
    }

    .modal {
        z-index: 1055 !important;
    }
</style>




@section ScriptManager
{

    <script>
        function AddSubCategoryModal(id) {
            $.ajax({
                url: "/Admin/AddSubCategory/" + id,
                type: "GET",
                success: function (result) {
                    $('#MiniModelBody').html(result);
                    $('#MiniModel').appendTo('body').modal({
                        backdrop: 'static',
                        keyboard: false,
                        show: true
                    });

                    BindFormMiniModal();
                }
            });
        }

        function EditCategoryModal(id) {
            $.ajax({
                url: "/Admin/EditCategory/" + id,
                type: "GET",
                success: function (result) {
                    $('#MiniModelBody').html(result);
                    $('#MiniModel').appendTo('body').modal({
                        backdrop: 'static',
                        keyboard: false,
                        show: true
                    });

                    BindFormMiniModal();
                }
            });
        }

        function DeleteCategoryModal(id) {
            $.ajax({
                url: "/Admin/DeleteCategory/" + id,
                type: "GET",
                success: function (result) {
                    $('#MiniModelBody').html(result);
                    $('#MiniModel').appendTo('body').modal({
                        backdrop: 'static',
                        keyboard: false,
                        show: true
                    });

                    BindFormMiniModal();
                }
            });
        }
    </script>
    <script src="~/js/bindforms.js"></script>
}
